var e,t,s,n,a="mwmbl",r="https://tinysearchengine-oq4r5q2hsq-ue.a.run.app/",i="q",l=(e,t,s)=>{const n=`${a}-${e}`;return customElements.get(n)||customElements.define(n,t,s),n},c={};e=c,t="default",s=()=>u,n=e=>u=e,Object.defineProperty(e,t,{get:s,set:n,enumerable:!0,configurable:!0});var u=(e,t=100)=>{let s;return(...n)=>{clearTimeout(s),s=setTimeout((()=>{e.apply(void 0,n)}),t)}};const o=new class{constructor(){this.element=document.createElement("div")}on(e,t){this.element.addEventListener(e,t)}dispatch(e){this.element.dispatchEvent(e)}};l("search-bar",class extends HTMLElement{constructor(){super(),this.searchInput=null,this.__setup()}__setup(){this.innerHTML=(this.dataset,"\n  <div class=\"search-bar\">\n    <i class=\"ph-magnifying-glass-bold\"></i>\n    <input type='search' class='search-bar-input' placeholder='Search on mwmbl...' title='Use \"CTRL+K\" or \"/\" to focus.'>\n  </div>\n"),this.searchInput=this.querySelector("input"),this.__events()}__events(){this.searchInput.addEventListener("input",c.default((async e=>{document.title=`MWMBL - ${this.searchInput.value||"Search"}`;const t=new URLSearchParams(document.location.search);this.searchInput.value?t.set(i,this.searchInput.value):t.delete(i);const s=document.location.protocol+"//"+document.location.host+document.location.pathname+(this.searchInput.value?"?":"")+t.toString();window.history.replaceState({path:s},"",s),this.searchInput.value?document.body.style.paddingTop="25px":document.body.style.paddingTop="30vh";const n=await(await fetch(`${r}search?s=${this.searchInput.value}`)).json(),a=new CustomEvent("search",{detail:this.searchInput.value?n:null});o.dispatch(a)}))),document.addEventListener("keydown",(e=>{("k"===e.key&&e.ctrlKey||"/"===e.key||"Escape"===e.key)&&(e.preventDefault(),this.searchInput.focus())})),this.addEventListener("keydown",(e=>{if("ArrowDown"===e.key&&this.searchInput.value){e.preventDefault();const t=new CustomEvent("focus-result");o.dispatch(t)}})),o.on("focus-search",(e=>{this.searchInput.focus()}))}connectedCallback(){this.searchInput.focus();const e=new URLSearchParams(document.location.search).get(i);this.searchInput.value=e,this.searchInput.dispatchEvent(new Event("input"))}});var h=l("result",class extends HTMLLIElement{constructor(){super(),this.classList.add("result"),this.__setup()}__setup(){this.innerHTML=(({data:e})=>`\n<a href='${e.url}'>\n  <p class='link'>${e.url}</p>\n  <p class='title'>${e.title}</p>\n  <p class='extract'>${e.extract}</p>\n</a>\n`)({data:this.dataset}),this.__events()}__events(){this.addEventListener("keydown",(e=>{if(this.firstElementChild===document.activeElement&&("ArrowDown"===e.key&&(e.preventDefault(),this?.nextElementSibling?.firstElementChild.focus()),"ArrowUp"===e.key))if(e.preventDefault(),this.previousElementSibling)this.previousElementSibling?.firstElementChild.focus();else{const e=new CustomEvent("focus-search");o.dispatch(e)}}))}},{extends:"li"});l("results",class extends HTMLElement{constructor(){super(),this.results=null,this.__setup()}__setup(){this.innerHTML=(this.dataset,"\n  <ul class='results'>\n    <li class=\"empty-result\">\n      Welcome to mwmbl, the free, open-source and non-profit search engine.\n      <br> \n      You can start searching by using the search bar above!\n    </li>\n  </ul>\n"),this.results=this.querySelector(".results"),this.__events()}__events(){o.on("search",(e=>{if(this.results.innerHTML="",e.detail)if(e.detail.length>0)for(const t of e.detail)this.results.innerHTML+=`\n            <li\n              is='${h}' \n              data-url='${this.__escapeString(t.url)}'\n              data-title='${this.__escapeString(this.__handleBold(t.title))}'\n              data-extract='${this.__escapeString(this.__handleBold(t.extract))}'\n            ></li>\n          `;else this.results.innerHTML='\n          <li \n            class="empty-result"\n          >We could not find anything for your search...</li>\n        ';else this.results.innerHTML='\n          <li class="empty-result">\n            Welcome to mwmbl, the free, open-source and non-profit search engine.\n            <br> \n            You can start searching by using the search bar above!\n          </li>\n        '})),o.on("focus-result",(()=>{this.results.firstElementChild.firstElementChild.focus()}))}__handleBold(e){let t="";for(const s of e)s.is_bold?t+=`<strong>${s.value}</strong>`:t+=s.value;return t}__escapeString(e){return e.replace(/\"/g,"&#34;").replace(/\'/g,"&#39;")}});
//# sourceMappingURL=index.84483763.js.map

{"mappings":"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","sources":["config.js","src/utils/define.js","src/utils/debounce.js","src/utils/events.js","src/components/search-bar.js","src/components/result.js","src/components/empty-result.js","src/components/home.js","src/components/results.js","src/components/footer.js"],"sourcesContent":["/**\n * This file is made for tweaking parameters on the front-end\n * without having to dive in the source code.\n * \n * THIS IS NOT A PLACE TO PUT SENSIBLE DATA LIKE API KEYS.\n * THIS FILE IS PUBLIC.\n */\n\nexport default {\n  componentPrefix: 'mwmbl',\n  publicApiURL: 'https://api.search.mwmbl.org/',\n  searchQueryParam: 'q',\n  footerLinks: [\n    {\n      name: 'Github',\n      icon: 'ph-github-logo-bold',\n      href: 'https://github.com/mwmbl/mwmbl'\n    },\n    {\n      name: 'Wiki',\n      icon: 'ph-info-bold',\n      href: 'https://github.com/mwmbl/mwmbl/wiki'\n    }\n  ]\n}","import config from '../../config.js';\n\n/** Define a web component, this is a wrapper\n *  around the `customElements.define` native function.\n * @function define \n * @param {string} name Name of the component (will be prefixed by the config `componentPrefix`)\n * @param {CustomElementConstructor} constructor\n * @param {ElementDefinitionOptions} [options]\n * @returns {string} Returns the element name ready for the DOM (.e.g `<search-bar></search-bar>`)\n */\n export default (name, constructor, options) => { \n  const componentName = `${config.componentPrefix}-${name}`;\n  if (!customElements.get(componentName)) customElements.define(componentName, constructor, options); \n  return componentName;\n}","/**\n * A debounce function to reduce input spam\n * @param {*} callback Function that will be called\n * @param {*} timeout Minimum amount of time between calls\n * @returns The debounced function\n */\nexport default (callback, timeout = 100) => {\n  let timer;\n  return (...args) => {\n      clearTimeout(timer);\n      timer = setTimeout(() => { callback.apply(this, args); }, timeout);\n  };\n}","/**\n * A class destined to be used as an event bus.\n * \n * It is simply a trick using a div element\n * to carry events.\n */\nclass Bus {\n  constructor() {\n    this.element = document.createElement('div');\n  }\n\n  on(eventName, callback) {\n    this.element.addEventListener(eventName, callback);\n  }\n\n  dispatch(event) {\n    this.element.dispatchEvent(event);\n  }\n}\n\n/**\n * A global event bus that can be used to\n * dispatch events in between components\n * */\nconst globalBus = new Bus();\n\nexport {\n  Bus,\n  globalBus,\n}","import define from '../utils/define.js';\nimport debounce from '../utils/debounce.js';\nimport config from '../../config.js';\nimport { globalBus } from '../utils/events.js';\n\nconst template = () => /*html*/`\n  <div class=\"search-bar\">\n    <i class=\"ph-magnifying-glass-bold\"></i>\n    <input type='search' class='search-bar-input' placeholder='Search on mwmbl...' title='Use \"CTRL+K\" or \"/\" to focus.'>\n  </div>\n`;\n\nexport default define('search-bar', class extends HTMLElement {\n  constructor() {\n    super();\n    this.searchInput = null;\n    this.__setup();\n  }\n\n  __setup() {\n    this.innerHTML = template();\n    this.searchInput = this.querySelector('input');\n    this.__events();\n  }\n\n  __events() {\n    this.searchInput.addEventListener('input', debounce(async (e) => {\n      // Update page title\n      document.title = `MWMBL - ${this.searchInput.value || \"Search\"}`;\n\n      // Update query params\n      const queryParams = new URLSearchParams(document.location.search);\n      // Sets query param if search value is not empty\n      if (this.searchInput.value) queryParams.set(config.searchQueryParam, this.searchInput.value);\n      else queryParams.delete(config.searchQueryParam);\n      // New URL with query params\n      const newURL = \n        document.location.protocol \n        + \"//\" \n        + document.location.host \n        + document.location.pathname \n        + (this.searchInput.value ? '?' : '')\n        + queryParams.toString();\n      // Replace history state\n      window.history.replaceState({ path: newURL }, '', newURL);\n\n      // Update body padding if search value is empty\n      if (this.searchInput.value) document.body.style.paddingTop = '25px';\n      else document.body.style.paddingTop = '30vh';\n      // Getting results from API\n      const search = await (await fetch(`${config.publicApiURL}search?s=${this.searchInput.value}`)).json();\n      // Creating a custom event to send search results\n      const searchEvent = new CustomEvent('search', {\n        detail: this.searchInput.value ? search : null,\n      });\n      // Dispatch search event throught the global event bus\n      globalBus.dispatch(searchEvent);\n    }));\n\n    // Focus search bar when pressing `ctrl + k` or `/`\n    document.addEventListener('keydown', (e) => {\n      if ((e.key === 'k' && e.ctrlKey) || e.key === '/' || e.key === 'Escape') {\n        e.preventDefault();\n        this.searchInput.focus();\n      }\n    });\n\n    // Focus first result when pressing down arrow\n    this.addEventListener('keydown', (e) => {\n      if (e.key === 'ArrowDown' && this.searchInput.value) {\n        e.preventDefault();\n        const focusResultEvent = new CustomEvent('focus-result');\n        globalBus.dispatch(focusResultEvent);\n      }\n    });\n\n    globalBus.on('focus-search', (e) => {\n      this.searchInput.focus();\n    });\n  }\n\n  connectedCallback() {\n    // Focus search input when component is connected\n    this.searchInput.focus();\n\n    const searchQuery = new URLSearchParams(document.location.search).get(config.searchQueryParam);\n    this.searchInput.value = searchQuery;\n    this.searchInput.dispatchEvent(new Event('input'));\n  }\n});","import define from '../utils/define.js';\nimport { globalBus } from '../utils/events.js';\n\nconst template = ({ data }) => /*html*/`\n  <a href='${data.url}'>\n    <p class='link'>${data.url}</p>\n    <p class='title'>${data.title}</p>\n    <p class='extract'>${data.extract}</p>\n  </a>\n`;\n\nexport default define('result', class extends HTMLLIElement {\n  constructor() {\n    super();\n    this.classList.add('result');\n    this.__setup();\n  }\n\n  __setup() {\n    this.innerHTML = template({ data: this.dataset });\n    this.__events();\n  }\n\n  __events() {\n    this.addEventListener('keydown', (e) => {\n      if (this.firstElementChild === document.activeElement) {\n        if (e.key === 'ArrowDown') {\n          e.preventDefault();\n          this?.nextElementSibling?.firstElementChild.focus();\n        }\n        if (e.key === 'ArrowUp') {\n          e.preventDefault();\n          if (this.previousElementSibling)\n            this.previousElementSibling?.firstElementChild.focus();\n          else {\n            const focusSearchEvent = new CustomEvent('focus-search');\n            globalBus.dispatch(focusSearchEvent);\n          }\n        }\n      }\n    })\n  }\n}, { extends: 'li' });","import define from '../utils/define.js';\nimport { globalBus } from '../utils/events.js';\n\nconst template = () => /*html*/`\n  <p>We could not find anything for your search...</p>\n`;\n\nexport default define('empty-result', class extends HTMLLIElement {\n  constructor() {\n    super();\n    this.classList.add('empty-result');\n    this.__setup();\n  }\n\n  __setup() {\n    this.innerHTML = template();\n  }\n}, { extends: 'li' });","import define from '../utils/define.js';\nimport { globalBus } from '../utils/events.js';\n\nconst template = () => /*html*/`\n  <p>\n    Welcome to mwmbl, the free, open-source and non-profit search engine.\n  </p>\n  <p>\n    You can start searching by using the search bar above!\n  </p>\n`;\n\nexport default define('home', class extends HTMLLIElement {\n  constructor() {\n    super();\n    this.classList.add('home');\n    this.__setup();\n  }\n\n  __setup() {\n    this.innerHTML = template();\n  }\n}, { extends: 'li' });","import define from '../utils/define.js';\nimport { globalBus } from '../utils/events.js';\n\n// Components\nimport result from './result.js';\nimport emptyResult from './empty-result.js';\nimport home from './home.js';\n\nconst template = () => /*html*/`\n  <ul class='results'>\n    <li is='${home}'></li>\n  </ul>\n`;\n\nexport default define('results', class extends HTMLElement {\n  constructor() {\n    super();\n    this.results = null;\n    this.__setup();\n  }\n\n  __setup() {\n    this.innerHTML = template();\n    this.results = this.querySelector('.results');\n    this.__events();\n  }\n\n  __events() {\n    globalBus.on('search', (e) => {\n      this.results.innerHTML = '';\n      // If there is no details the input is empty \n      if (!e.detail) {\n        this.results.innerHTML = /*html*/`\n          <li is='${home}'></li>\n        `;\n      }\n      // If the details array has results display them\n      else if (e.detail.length > 0) {\n        for(const resultData of e.detail) {\n          this.results.innerHTML += /*html*/`\n            <li\n              is='${result}' \n              data-url='${this.__escapeString(resultData.url)}'\n              data-title='${this.__escapeString(this.__handleBold(resultData.title))}'\n              data-extract='${this.__escapeString(this.__handleBold(resultData.extract))}'\n            ></li>\n          `;\n        }\n      }\n      // If the details array is empty there is no result\n      else {\n        this.results.innerHTML = /*html*/`\n          <li is='${emptyResult}'></li>\n        `;\n      }\n    });\n\n    // Focus first element when coming from the search bar\n    globalBus.on('focus-result', () => {\n      this.results.firstElementChild.firstElementChild.focus();\n    })\n  }\n\n  __handleBold(input) {\n    let text = '';\n    for (const part of input) {\n      if (part.is_bold) text += `<strong>${part.value}</strong>`;\n      else text += part.value;\n    }\n    return text;\n  }\n\n  __escapeString(input) {\n    return input\n      .replace(/\\\"/g,'&#34;')\n      .replace(/\\'/g,'&#39;')\n  }\n});","import define from '../utils/define.js';\nimport config from '../../config.js';\n\nconst template = ({ data }) => /*html*/`\n  <p class=\"footer-text\">Find more on</p>\n  <ul class=\"footer-list\">\n    ${ data.links.map(link => /*html*/`\n      <li class=\"footer-item\">\n        <a href=\"${link.href}\" class=\"footer-link\" target=\"__blank\">\n          <i class=\"${link.icon}\"></i>\n          <span>${link.name}</span>\n        </a>\n      </li>\n    `).join('') }\n  </ul>\n`;\n\nexport default define('footer', class extends HTMLElement {\n  constructor() {\n    super();\n    this.__setup();\n  }\n\n  __setup() {\n    this.innerHTML = template({ \n      data: {\n        links: config.footerLinks\n      }\n    });\n    this.__events();\n  }\n\n  __events() {\n    \n  }\n}, { extends: 'footer' });"],"names":["$c10fc4dd470a6ad9$export$2e2bcd8739ae039","componentPrefix","publicApiURL","searchQueryParam","footerLinks","name","icon","href","$df526096dea60be7$export$2e2bcd8739ae039","constructor","options","componentName","customElements","get","define","$9bcc5e699e8d80f4$export$2e2bcd8739ae039","callback","timeout","timer","args","clearTimeout","setTimeout","apply","undefined","$e25981b1e1807383$export$61d2f5675cf9cb15","this","element","document","createElement","on","eventName","addEventListener","dispatch","event","dispatchEvent","HTMLElement","super","searchInput","__setup","innerHTML","querySelector","__events","$9bcc5e699e8d80f4$exports","default","async","e","title","value","queryParams","URLSearchParams","location","search","set","delete","newURL","protocol","host","pathname","toString","window","history","replaceState","path","body","style","paddingTop","fetch","json","searchEvent","CustomEvent","detail","key","ctrlKey","preventDefault","focus","focusResultEvent","connectedCallback","searchQuery","Event","$5890c34a381276d1$export$2e2bcd8739ae039","HTMLLIElement","classList","add","data","url","extract","$5890c34a381276d1$var$template","dataset","firstElementChild","activeElement","nextElementSibling","previousElementSibling","focusSearchEvent","extends","$2c247046f39cc7e0$export$2e2bcd8739ae039","$41842afbef9dd12d$export$2e2bcd8739ae039","results","length","resultData","__escapeString","__handleBold","input","text","part","is_bold","replace","links","map","link","join","$3e595d6bb3c29eb5$var$template"],"version":3,"file":"index.aac1c161.js.map"}
{"mappings":"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","sources":["config.js","src/utils/define.js","src/utils/debounce.js","src/utils/events.js","src/components/search-bar.js","src/components/result.js","src/components/results.js"],"sourcesContent":["/**\n * This file is made for tweaking parameters on the front-end\n * without having to dive in the source code.\n * \n * THIS IS NOT A PLACE TO PUT SENSIBLE DATA LIKE API KEYS.\n * THIS FILE IS PUBLIC.\n */\n\nexport default {\n  componentPrefix: 'mwmbl',\n  publicApiURL: 'https://tinysearchengine-oq4r5q2hsq-ue.a.run.app/',\n}","import config from '../../config.js';\n\n/** Define a web component, this is a wrapper\n *  around the `customElements.define` native function.\n * @function define \n * @param {string} name Name of the component (will be prefixed by the config `componentPrefix`)\n * @param {CustomElementConstructor} constructor\n * @param {ElementDefinitionOptions} [options]\n * @returns {string} Returns the element name ready for the DOM (.e.g `<search-bar></search-bar>`)\n */\n export default (name, constructor, options) => { \n  const componentName = `${config.componentPrefix}-${name}`;\n  if (!customElements.get(componentName)) customElements.define(componentName, constructor, options); \n  return componentName;\n}","/**\n * A debounce function to reduce input spam\n * @param {*} callback Function that will be called\n * @param {*} timeout Minimum amount of time between calls\n * @returns The debounced function\n */\nexport default (callback, timeout = 100) => {\n  let timer;\n  return (...args) => {\n      clearTimeout(timer);\n      timer = setTimeout(() => { callback.apply(this, args); }, timeout);\n  };\n}","/**\n * A class destined to be used as an event bus.\n * \n * It is simply a trick using a div element\n * to carry events.\n */\nclass Bus {\n  constructor() {\n    this.element = document.createElement('div');\n  }\n\n  on(eventName, callback) {\n    this.element.addEventListener(eventName, callback);\n  }\n\n  dispatch(event) {\n    this.element.dispatchEvent(event);\n  }\n}\n\n/**\n * A global event bus that can be used to\n * dispatch events in between components\n * */\nconst globalBus = new Bus();\n\nexport {\n  Bus,\n  globalBus,\n}","import define from '../utils/define.js';\nimport debounce from '../utils/debounce.js';\nimport config from '../../config.js';\nimport { globalBus } from '../utils/events.js';\n\nconst template = ({ data }) => /*html*/`\n  <div class=\"search-bar\">\n    <i class=\"ph-magnifying-glass-bold\"></i>\n    <input type='search' class='search-bar-input' placeholder='Search on mwmbl...' title='Use \"CTRL+K\" or \"/\" to focus.'>\n  </div>\n`;\n\nexport default define('search-bar', class extends HTMLElement {\n  constructor() {\n    super();\n    this.searchInput = null;\n    this.__setup();\n  }\n\n  __setup() {\n    this.innerHTML = template({ data: this.dataset });\n    this.searchInput = this.querySelector('input');\n    this.__events();\n  }\n\n  __events() {\n    this.searchInput.addEventListener('input', debounce(async (e) => {\n      // Update page title on search input\n      document.title = `MWMBL - ${this.searchInput.value || \"Search\"}`;\n      // Update body padding if search value is empty\n      if (this.searchInput.value) document.body.style.paddingTop = '25px';\n      else document.body.style.paddingTop = '30vh';\n      // Getting results from API\n      const search = await (await fetch(`${config.publicApiURL}search?s=${this.searchInput.value}`)).json();\n      // Creating a custom event to send search results\n      const searchEvent = new CustomEvent('search', {\n        detail: this.searchInput.value ? search : null,\n      });\n      // Dispatch search event throught the global event bus\n      globalBus.dispatch(searchEvent);\n    }));\n\n    // Focus search bar when pressing `ctrl + k` or `/`\n    document.addEventListener('keydown', (e) => {\n      if ((e.key === 'k' && e.ctrlKey) || e.key === '/') {\n        e.preventDefault();\n        this.searchInput.focus();\n      }\n    });\n\n    // Focus first result when pressing down arrow\n    this.addEventListener('keydown', (e) => {\n      if (e.key === 'ArrowDown' && this.searchInput.value) {\n        e.preventDefault();\n        const focusResultEvent = new CustomEvent('focus-result');\n        globalBus.dispatch(focusResultEvent);\n      }\n    })\n  }\n\n  connectedCallback() {\n    // Focus search input when component is connected\n    this.searchInput.focus();\n  }\n});","import define from '../utils/define.js';\n\nconst template = ({ data }) => /*html*/`\n<a href='${data.url}'>\n  <p class='link'>${data.url}</p>\n  <p class='title'>${data.title}</p>\n  <p class='extract'>${data.extract}</p>\n</a>\n`;\n\nexport default define('result', class extends HTMLLIElement {\n  constructor() {\n    super();\n    this.classList.add('result');\n    this.__setup();\n  }\n\n  __setup() {\n    this.innerHTML = template({ data: this.dataset });\n    this.__events();\n  }\n\n  __events() {\n    this.addEventListener('keydown', (e) => {\n      if (this.firstElementChild === document.activeElement) {\n        if (e.key === 'ArrowDown') {\n          e.preventDefault();\n          this?.nextElementSibling?.firstElementChild.focus();\n        }\n        if (e.key === 'ArrowUp') {\n          e.preventDefault();\n          this?.previousElementSibling?.firstElementChild.focus();\n        }\n      }\n    })\n  }\n}, { extends: 'li' });","import define from '../utils/define.js';\nimport { globalBus } from '../utils/events.js';\nimport result from './result.js';\n\nconst template = () => /*html*/`\n  <ul class='results'>\n    <li class=\"empty-result\">\n      Welcome to mwmbl, the free, open-source and non-profit search engine.\n      <br> \n      You can start searching by using the search bar above!\n    </li>\n  </ul>\n`;\n\nexport default define('results', class extends HTMLElement {\n  constructor() {\n    super();\n    this.results = null;\n    this.__setup();\n  }\n\n  __setup() {\n    this.innerHTML = template({ data: this.dataset });\n    this.results = this.querySelector('.results');\n    this.__events();\n  }\n\n  __events() {\n    globalBus.on('search', (e) => {\n      this.results.innerHTML = '';\n      // If there is no details the input is empty \n      if (!e.detail) {\n        this.results.innerHTML = /*html*/`\n          <li class=\"empty-result\">\n            Welcome to mwmbl, the free, open-source and non-profit search engine.\n            <br> \n            You can start searching by using the search bar above!\n          </li>\n        `;\n      }\n      // If the details array has results display them\n      else if (e.detail.length > 0) {\n        for(const resultData of e.detail) {\n          this.results.innerHTML += /*html*/`\n            <li\n              is='${result}' \n              data-url='${this.__escapeString(resultData.url)}'\n              data-title='${this.__escapeString(this.__handleBold(resultData.title))}'\n              data-extract='${this.__escapeString(this.__handleBold(resultData.extract))}'\n            ></li>\n          `;\n        }\n      }\n      // If the details array is empty there is no result\n      else {\n        this.results.innerHTML = /*html*/`\n          <li \n            class=\"empty-result\"\n          >We could not find anything for your search...</li>\n        `;\n      }\n    });\n\n    // Focus first element when coming from the search bar\n    globalBus.on('focus-result', () => {\n      this.results.firstElementChild.firstElementChild.focus();\n    })\n  }\n\n  __handleBold(input) {\n    let text = '';\n    for (const part of input) {\n      if (part.is_bold) text += `<strong>${part.value}</strong>`;\n      else text += part.value;\n    }\n    return text;\n  }\n\n  __escapeString(input) {\n    return input\n      .replace(/\\\"/g,'&#34;')\n      .replace(/\\'/g,'&#39;')\n  }\n});"],"names":["$c10fc4dd470a6ad9$export$2e2bcd8739ae039","$df526096dea60be7$export$2e2bcd8739ae039","name","constructor","options","componentName","customElements","get","define","$9bcc5e699e8d80f4$export$2e2bcd8739ae039","callback","timeout","timer","args","clearTimeout","setTimeout","apply","undefined","$e25981b1e1807383$export$61d2f5675cf9cb15","this","element","document","createElement","on","eventName","addEventListener","dispatch","event","dispatchEvent","HTMLElement","super","searchInput","__setup","innerHTML","dataset","querySelector","__events","$9bcc5e699e8d80f4$exports","default","async","e","title","value","body","style","paddingTop","search","fetch","json","searchEvent","CustomEvent","detail","key","ctrlKey","preventDefault","focus","focusResultEvent","connectedCallback","$5890c34a381276d1$export$2e2bcd8739ae039","HTMLLIElement","classList","add","data","url","extract","$5890c34a381276d1$var$template","firstElementChild","activeElement","nextElementSibling","previousElementSibling","extends","results","length","resultData","__escapeString","__handleBold","input","text","part","is_bold","replace"],"version":3,"file":"index.6f62fd83.js.map"}